# ููุฎุต ุงูุฏูุฌ ูุงูุฑุจุท - ูุญูุธุชู ุงูุฃุฎุฑููุฉ

## โ ูุง ุชู ุฅูุฌุงุฒู ุจุงููุงูู

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑุฌุนูุฉ (Data Layer)

#### ๐ ุงููููุงุช ุงููููุดุฃุฉ:

| ุงูููู | ุงูุนุฏุฏ | ุงููุตู |
|------|-------|-------|
| `src/data/types.ts` | - | ุฌููุน ุงูุชุนุฑููุงุช ูุงููุงุฌูุงุช |
| `src/data/hadithsData.ts` | 20+ | ุงูุฃุญุงุฏูุซ ุงููุจููุฉ ุงูููุซูุฉ |
| `src/data/assetsData.ts` | 30+ | ุงูุฃุตูู ุงูุงุณุชุซูุงุฑูุฉ (7 ูุฆุงุช) |
| `src/data/opportunitiesData.ts` | 15+ | ุงููุฑุต ุงูููููุฉ ุงููุญูุฒุฉ |
| `src/data/risksData.ts` | 10+ | ุงููุฎุงุทุฑ ูุทุฑู ุงูููุงูุฉ |
| `src/data/index.ts` | - | ุงูุชุตุฏูุฑ ุงููุฑูุฒู |

#### ๐ ุงูุฅุญุตุงุฆูุงุช:

```
๐ ุงูุฃุญุงุฏูุซ: 20+ ุญุฏูุซ ุตุญูุญ ูุญุณู
๐ ุงูุฃุตูู: 30+ ุฃุตู ูู 7 ูุฆุงุช
โญ ุงููุฑุต: 15+ ูุฑุตุฉ ููููุฉ
โ๏ธ ุงููุฎุงุทุฑ: 10+ ูุฎุงุทุฑ ููุซูุฉ
๐ ุงููุฑุงุฌุน: ูู ุญุฏูุซ ูู ุฑุงุจุท ูุฑุฌุนู
```

---

### 2. ูุงุนุฏุฉ ุจูุงูุงุช Supabase (Database Layer)

#### ๐ Migration ุงููููุดุฃุฉ:

**ุงูููู:** `supabase/migrations/20251117000000_create_user_assets.sql`

#### ๐๏ธ ุงูุฌุฏุงูู (6 ุฌุฏุงูู):

1. **user_profiles** - ุงููููุงุช ุงูุดุฎุตูุฉ
   ```sql
   - id, full_name, age, gender
   - created_at, updated_at
   ```

2. **user_assets** - ุฃุตูู ุงููุณุชุฎุฏู
   ```sql
   - id, user_id, asset_id, asset_type
   - category, value, notes
   - created_at, updated_at
   ```

3. **action_records** - ุณุฌู ุงูุฃุนูุงู
   ```sql
   - id, user_id, asset_id
   - action_type, value, notes, date
   - created_at
   ```

4. **daily_goals** - ุงูุฃูุฏุงู ุงูููููุฉ
   ```sql
   - id, user_id, opportunity_id
   - target_value, current_value
   - completed, date, completed_at
   ```

5. **reminders** - ุงูุชุฐููุฑุงุช
   ```sql
   - id, user_id, title, description
   - reminder_time, days_of_week
   - is_active, created_at
   ```

6. **achievements** - ุงูุฅูุฌุงุฒุงุช
   ```sql
   - id, user_id, achievement_type
   - title, description, achieved_at
   ```

#### โ๏ธ ุงูุฏูุงู (2 ุฏุงูุฉ):

1. **get_user_total_assets()** - ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช
   ```sql
   Returns: total_houses, total_trees, 
            total_continuous, total_social
   ```

2. **handle_new_user()** - ุฅูุดุงุก ุงูููู ุชููุงุฆูุงู
   ```sql
   Trigger: ุนูุฏ ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ
   ```

#### ๐ ุงูุฃูุงู (RLS):

- โ Row Level Security ููุนูู
- โ 15+ ุณูุงุณุฉ ุฃูุงู
- โ ูู ูุณุชุฎุฏู ูุฑู ุจูุงูุงุชู ููุท

---

### 3. React Hooks (Logic Layer)

#### ๐ ุงูููู ุงููููุดุฃ:

**`src/hooks/useUserAssets.ts`**

#### ๐ฃ ุงูู Hooks ุงููุชุงุญุฉ:

| Hook | ุงููุธููุฉ |
|------|---------|
| `useUserAssets()` | ุฌูุจ ุฌููุน ุฃุตูู ุงููุณุชุฎุฏู |
| `useTotalAssets()` | ุฌูุจ ุงูุฅุญุตุงุฆูุงุช ุงูุฅุฌูุงููุฉ |
| `useAssetByAssetId()` | ุฌูุจ ุฃุตู ูุนูู |
| `useUpsertAsset()` | ุฅุถุงูุฉ ุฃู ุชุญุฏูุซ ุฃุตู |
| `useDeleteAsset()` | ุญุฐู ุฃุตู |
| `useActionRecords()` | ุฌูุจ ุณุฌู ุงูุฃุนูุงู |

#### ๐ ุงูุชูุงูู ูุน React Query:

- โ Caching ุชููุงุฆู
- โ Invalidation ุฐูู
- โ Loading states
- โ Error handling

---

### 4. ุงูููููุงุช ุงููุญุฏุซุฉ (UI Layer)

#### โ ุงูููููุงุช ุงููุฏูุฌุฉ:

##### 1. **AssetsOverview.tsx**
```typescript
// ูุจู: ุจูุงูุงุช ุซุงุจุชุฉ (5, 250, 3)
// ุจุนุฏ: ุจูุงูุงุช ุญูุฉ ูู useTotalAssets()
```
- โ ูุนุฑุถ ุงูุฅุญุตุงุฆูุงุช ุงูุญููููุฉ
- โ Loading state
- โ ุชุญุฏูุซ ุชููุงุฆู

##### 2. **AssetDetailCards.tsx**
```typescript
// ูุจู: ุจูุงูุงุช ุซุงุจุชุฉ ููุชูุจุฉ ูู ุงูููุฏ
// ุจุนุฏ: ุจูุงูุงุช ูู assetCategories + useUserAssets()
```
- โ ูุนุฑุถ ุฌููุน ุงููุฆุงุช ูู ุงูุจูุงูุงุช ุงููุฑุฌุนูุฉ
- โ ูุญุณุจ ูููุฉ ูู ุฃุตู ูู ุจูุงูุงุช ุงููุณุชุฎุฏู
- โ ูุงุจู ููููุฑ ูุนุฑุถ ุงูุชูุงุตูู
- โ ุนุฑุถ ุงูุถุงูู (ุงููุจู ๏ทบ)

##### 3. **AssetDetailsDialog.tsx** (ุฌุฏูุฏ!)
```typescript
// ูููู ุฌุฏูุฏ ุชูุงูุงู
```
- โ ุนุฑุถ ุงูุญุฏูุซ ูุงููุงู
- โ ุชูุงุตูู ุงูุฃุตู ุงูุดุงููุฉ
- โ ูููุฐุฌ ุฅุถุงูุฉ ูุจุงุดุฑ
- โ ุนุฑุถ ุงููุฑุฌุน ูุน ุฑุงุจุท

##### 4. **TodayOpportunities.tsx**
```typescript
// ูุจู: 4 ูุฑุต ุซุงุจุชุฉ
// ุจุนุฏ: ูุฑุต ูู dailyOpportunities (ูููุชุฑุฉ)
```
- โ ูุนุฑุถ ุงููุฑุต ุนุงููุฉ ุงูุฃููููุฉ
- โ ุนุฑุถ ุงูููุช ุงููุชููุน
- โ ุนุฑุถ ุงูุถุงูู
- โ ุจูุงูุงุช ููุซูุฉ

##### 5. **RiskManagement.tsx**
```typescript
// ูุจู: 3 ูุฎุงุทุฑ ุซุงุจุชุฉ
// ุจุนุฏ: ูุฎุงุทุฑ ูู risksData
```
- โ 5 ูุฎุงุทุฑ ููุซูุฉ
- โ ุชุตููู ุญุณุจ ุงูุฎุทูุฑุฉ
- โ ุฃููุงู ูุฎุชููุฉ ููุฎุทูุฑุฉ
- โ ุฃูุซูุฉ ุนูููุฉ

##### 6. **AddActionDialog.tsx**
```typescript
// ูุจู: ูุงุฌูุฉ ุจุณูุทุฉ
// ุจุนุฏ: ูููุฐุฌ ูุชูุงูู (AddActionForm)
```
- โ ุงุฎุชูุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุนุฑุถ ุงูุชูุงุตูู ูุจู ุงูุญูุธ
- โ ุญูุธ ูู Supabase
- โ ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช

##### 7. **AddActionForm.tsx** (ุฌุฏูุฏ!)
```typescript
// ูููุฐุฌ ูุชุทูุฑ ููุฅุถุงูุฉ
```
- โ ุงุฎุชูุงุฑ ุงููุฆุฉ ุซู ุงูุฃุตู
- โ ุนุฑุถ ุชูุงุตูู ุงูุฃุตู
- โ ุฅุฏุฎุงู ุงููููุฉ
- โ ููุงุญุธุงุช ุงุฎุชูุงุฑูุฉ
- โ ุญูุธ ูุน feedback

---

### 5. ุงูุชูุณูู ุงูุนุฑุจู (Styling Layer)

#### โ ุงูุชุญุฏูุซุงุช:

- โ `<html lang="ar" dir="rtl">`
- โ ุฎุท Cairo ูู Google Fonts
- โ `direction: rtl` ูู CSS
- โ ุชุตุญูุญ ุฌููุน ุงูู margins (ml โ mr)
- โ ุชุตุญูุญ ุงูู borders (border-r โ border-l)
- โ ุชุตุญูุญ ุงูู positions (left โ right)
- โ ูุญุงุฐุงุฉ ุงููุตูุต ููุนุฑุจูุฉ

---

## ๐ ุชุฏูู ุงูุจูุงูุงุช ุงููุงูู

```
ุงููุณุชุฎุฏู ูุณุฌู ุนูู
        โ
AddActionForm (UI)
        โ
useUpsertAsset (Hook)
        โ
Supabase (Database)
        โ
React Query (Cache Update)
        โ
Components Re-render
        โ
AssetsOverview ูุธูุฑ ุงูุฅุญุตุงุฆูุงุช ุงููุญุฏุซุฉ
AssetDetailCards ูุธูุฑ ุงูููู ุงูุฌุฏูุฏุฉ
```

---

## ๐ ููุงุฑูุฉ ูุจู/ุจุนุฏ

### ูุจู ุงูุฏูุฌ:

```
โ ุจูุงูุงุช ุซุงุจุชุฉ ูู ุงูููุฏ
โ ูุง ููุฌุฏ ุญูุธ
โ ูุง ููุฌุฏ ุชุชุจุน
โ ููู ููููุฉ
โ ูุง ุชูุฌุฏ ูุฑุงุฌุน ููุฃุญุงุฏูุซ
```

### ุจุนุฏ ุงูุฏูุฌ:

```
โ ูุงุนุฏุฉ ุจูุงูุงุช ููุซูุฉ (50+ ุนูุตุฑ)
โ ุญูุธ ูู Supabase
โ ุชุชุจุน ุญู ููุชูุฏู
โ ููู ุญููููุฉ ูู ุงููุณุชุฎุฏู
โ ูู ุฃุตู ูู ุญุฏูุซู ููุฑุฌุนู
โ ุญูุงุฑุงุช ุชูุงุนููุฉ ููุชูุงุตูู
โ ูุธุงู ุฅุถุงูุฉ ูุชูุงูู
```

---

## ๐จ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ            User Interface (UI)              โ
โ  Dashboard, Cards, Dialogs, Forms           โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
โโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          React Hooks (Logic)                โ
โ  useUserAssets, useTotalAssets, etc.        โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
โโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         React Query (Caching)               โ
โ  Query cache, Invalidation, Updates         โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
โโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         Supabase Client (API)               โ
โ  Authentication, Database calls             โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
โโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ       Supabase Database (Storage)           โ
โ  PostgreSQL + RLS + Functions               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โฒ
                   โ
โโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Reference Data (src/data/)             โ
โ  Types, Hadiths, Assets, Opportunities      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฏ ุงูุฎุทูุฉ ุงูุชุงููุฉ: ุงูุชุทุจูู!

### 1. ุชุทุจูู ุงูู Migration
ุงุชุจุน `DATABASE_SETUP.md`

### 2. ุงุฎุชุจุฑ ุงูุชุทุจูู
```bash
npm run dev
```

### 3. ุฌุฑูุจ ุงูููุฒุงุช
- ุณุฌูู ุฏุฎูู
- ุฃุถู ุนูู ุตุงูุญ
- ุดุงูุฏ ุงูุฅุญุตุงุฆูุงุช ุชุชุญุฏุซ
- ุงูุชุญ ุชูุงุตูู ุฃุตู
- ุงูุฑุฃ ุงูุญุฏูุซ ูุงูุดุฑุญ

---

## ๐ ุงูููุฎุต ุงูุฅุญุตุงุฆู

| ุงููููู | ุงูุญุงูุฉ | ุงูุชูุงุตูู |
|--------|--------|----------|
| ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฑุฌุนูุฉ | โ ูุงูู | 50+ ุนูุตุฑ ููุซู |
| Schema ูุงุนุฏุฉ ุงูุจูุงูุงุช | โ ูุงูู | 6 ุฌุฏุงูู + 2 ุฏุงูุฉ |
| React Hooks | โ ูุงูู | 6 hooks ุฌุงูุฒุฉ |
| ุชุญุฏูุซ ุงูููููุงุช | โ ูุงูู | 7 ููููุงุช ูุญุฏุซุฉ |
| ุญูุงุฑุงุช ุงูุชูุงุตูู | โ ูุงูู | 2 ุญูุงุฑ ุฌุฏูุฏ |
| ูุธุงู ุงูุญูุธ | โ ูุงูู | ูุชูุงูู ูุน Supabase |
| ุงูุชูุณูู ุงูุนุฑุจู | โ ูุงูู | RTL ุดุงูู |
| ุงูุชูุซูู | โ ูุงูู | 5+ ูููุงุช ุชูุซูู |

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุงูุชุทุจูู ุงูุขู:

โ **ูุจูู ุนูู ุฃุณุงุณ ุนููู ูุชูู**: ูุซููุฉ "ุจูุงุก ุงูุขุฎุฑุฉ ูู ุงูุณูุฉ ุงููุจููุฉ"

โ **ููุซู ุจุงููุงูู**: ูู ูุนูููุฉ ููุง ูุฑุฌุนูุง

โ **ุชูุงุนูู ูุญู**: ุงูุจูุงูุงุช ุชูุญูุธ ูุชูุญุฏูุซ ููุฑูุงู

โ **ูุญูุฒ ููุดุฌุน**: ูุงุฌูุฉ ุฌุฐุงุจุฉ ููุฑุต ููููุฉ

โ **ุนุฑุจู ุฃุตูู**: ุชูุณูู RTL ูุงูู ูุฎุท ุนุฑุจู

โ **ูุงุจู ููุชูุณุน**: ุจููุฉ ุชุณูุญ ุจุฅุถุงูุฉ ุงููุฒูุฏ

โ **ุขูู ููุญูู**: RLS ูุณูุงุณุงุช ุฃูุงู ุดุงููุฉ

---

## ๐ ุฌุงูุฒ ููุฅุทูุงู!

> **"ูููููู ุฃูุญูุณููู ููููููุง ููููููู ุฏูุนูุง ุฅูููู ุงูููููู ููุนููููู ุตูุงููุญูุง"**

**ุจุงุฑู ุงููู ูู ุฌููุฏู ูุฌุนู ูุฐุง ุงูุนูู ูู ููุฒุงู ุญุณูุงุชู** ๐คฒ

---

*ุขุฎุฑ ุชุญุฏูุซ: 17 ููููุจุฑ 2025*

