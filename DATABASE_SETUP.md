# ุฏููู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ุงูุทุฑููุฉ 1: ุชุทุจูู ุงูู Migration ูุจุงุดุฑุฉ (ููุตู ุจูุง)

1. ุงูุชุญ ููุญุฉ ุชุญูู Supabase: https://supabase.com/dashboard
2. ุงุฐูุจ ุฅูู ูุดุฑูุนู
3. ุงุถุบุท ุนูู **SQL Editor** ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
4. ุงุถุบุท **New Query**
5. ุงูุณุฎ ูุญุชูู ุงูููู ุงูุชุงูู ุจุงููุงูู:
   ```
   supabase/migrations/20251117000000_create_user_assets.sql
   ```
6. ุงูุตู ุงููุญุชูู ูู ูุญุฑุฑ SQL
7. ุงุถุบุท **Run** ุฃู **Ctrl+Enter**

### โ ูุง ุณูุชู ุฅูุดุงุคู:

#### ุงูุฌุฏุงูู (Tables):
1. **user_profiles** - ูููุงุช ุงููุณุชุฎุฏููู ุงูููุณุนุฉ
2. **user_assets** - ุฃุตูู ุงููุณุชุฎุฏู (ุงูุฃุนูุงู ุงููุณุฌูุฉ)
3. **action_records** - ุณุฌู ุงูุฃุนูุงู ุงูููููุฉ
4. **daily_goals** - ุงูุฃูุฏุงู ุงูููููุฉ
5. **reminders** - ุงูุชุฐููุฑุงุช
6. **achievements** - ุงูุฅูุฌุงุฒุงุช

#### ุงูุฏูุงู (Functions):
- `get_user_total_assets()` - ุญุณุงุจ ุฅุฌูุงูู ุงูุฃุตูู
- `handle_new_user()` - ุฅูุดุงุก ููู ุชููุงุฆูุงู ุนูุฏ ุงูุชุณุฌูู

#### ุงูุฃูุงู (RLS - Row Level Security):
- ูู ูุณุชุฎุฏู ูุฑู ุจูุงูุงุชู ููุท
- ุณูุงุณุงุช ุฃูุงู ูุงููุฉ ุนูู ุฌููุน ุงูุฌุฏุงูู

---

## ุงูุทุฑููุฉ 2: ุจุงุณุชุฎุฏุงู Supabase CLI (ูููุชูุฏููู)

```bash
# 1. ุชุณุฌูู ุงูุฏุฎูู
npx supabase login

# 2. ุฑุจุท ุงููุดุฑูุน
npx supabase link --project-ref YOUR_PROJECT_REF

# 3. ุชุทุจูู ุงูู migrations
npx supabase db push

# 4. ุงูุชุญูู ูู ุงููุฌุงุญ
npx supabase db remote commit
```

---

## ุงูุชุญูู ูู ุงููุฌุงุญ

ุจุนุฏ ุชุทุจูู ุงูู migrationุ ุชุญูู ูู:

### ูู Supabase Dashboard:

1. ุงุฐูุจ ุฅูู **Table Editor**
2. ูุฌุจ ุฃู ุชุฑู ุงูุฌุฏุงูู ุงูุชุงููุฉ:
   - โ user_profiles
   - โ user_assets
   - โ action_records
   - โ daily_goals
   - โ reminders
   - โ achievements

3. ุงุฐูุจ ุฅูู **Database** โ **Functions**
4. ูุฌุจ ุฃู ุชุฑู:
   - โ get_user_total_assets
   - โ handle_new_user

### ูู ุงูุชุทุจูู:

ุจุนุฏ ุชุทุจูู ุงูู migrationุ ููููู:
1. ุชุณุฌูู ุงูุฏุฎูู/ุฅูุดุงุก ุญุณุงุจ
2. ุฅุถุงูุฉ ุฃุนูุงู ุตุงูุญุฉ
3. ุฑุคูุฉ ุงูุฅุญุตุงุฆูุงุช ุชุชุญุฏุซ ุชููุงุฆูุงู
4. ุชุชุจุน ุงูุชูุฏู

---

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "permission denied"

ุงูุญู: ุชุฃูุฏ ูู ุฃูู ุตุงุญุจ ุงููุดุฑูุน ุฃู ูุฏูู ุตูุงุญูุงุช ุงููุชุงุจุฉ

### ุฎุทุฃ: "relation already exists"

ุงูุญู: ุงูุฌุฏุงูู ููุฌูุฏุฉ ุจุงููุนู - ูุง ุฏุงุนู ููููู

### ุฎุทุฃ: "function already exists"

ุงูุญู: ุงูุฏูุงู ููุฌูุฏุฉ ุจุงููุนู - ูุง ุฏุงุนู ููููู

---

## ุงูุจูุงูุงุช ุงูุงุจุชุฏุงุฆูุฉ (ุงุฎุชูุงุฑู)

ุฅุฐุง ุฃุฑุฏุช ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ:

```sql
-- ุฅุถุงูุฉ ุฃุตูู ุชุฌุฑูุจูุฉ
INSERT INTO user_assets (user_id, asset_id, asset_type, category, value)
VALUES 
  (auth.uid(), 'tree-subhan', 'ุฒุฑุงุนู', 'agricultural', 100),
  (auth.uid(), 'house-aala', 'ุณูููู', 'real-estate-behavioral', 1),
  (auth.uid(), 'sadaqa-jariya', 'ุฌุงุฑู', 'continuous-income', 2);
```

---

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุจุนุฏ ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุงูุชุทุจูู ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐

ููููู:
- โ ุชุณุฌูู ุฃุนูุงูู ุงูุตุงูุญุฉ
- โ ุชุชุจุน ุฃุตููู ูู ุงูุฌูุฉ
- โ ุฑุคูุฉ ุงูุฅุญุตุงุฆูุงุช ุงูุญูุฉ
- โ ูุชุงุจุนุฉ ุงููุฑุต ุงูููููุฉ
- โ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ

**ุจุงุฑู ุงููู ููู ูุงุฌุนู ูุฐุง ุงูุนูู ูู ููุฒุงู ุญุณูุงุชู** ๐คฒ

